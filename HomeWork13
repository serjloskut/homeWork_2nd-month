using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;

namespace HomeWork1
{
    class Program
    {
        static void Main(string[] args)
        {
            Aquarium aquarium = new Aquarium();
            aquarium.Life();
        }
    }

    class Aquarium
    {
        private List<Fish> _fishes;
        private int _fishCount;
        private int _fishMax;
        private int _ageOfDeath;
        private Random _random = new Random();

        public bool IsFull { get; private set; }

        public Aquarium()
        {
            _fishes = new List<Fish>();
            _fishMax = _random.Next(3,10);
            _ageOfDeath = 7;
            IsFull = false;
        }

        public void Life()
        {
            bool isContinue = true;

            while (isContinue)
            {
                Console.SetCursorPosition(0, 10);
                ShowInfo();

                if (_fishCount == 0)
                    Console.WriteLine("Аквариум пустой.");
                else
                    Console.WriteLine($"Заполненость аквариума {_fishCount} из {_fishMax}. Максимальный возраст рыбы {_ageOfDeath} лет");

                Console.SetCursorPosition(0,0);
                Console.WriteLine("1. Добавить рыбу.\n" +
                    "2. Достать рыбу.\n" +
                    "3. Прожить 1 год.\n" +
                    "4. Выйти из программы.");
                Console.Write("Введите номер команды: ");

                switch (Console.ReadLine())
                {
                    case "1":
                        AddFish();
                        break;
                    case "2":
                        GetOutFish();
                        break;
                    case "3":
                        SkipYear();
                        break;
                    case "4":
                        isContinue=false;
                        break;
                    default:
                        SkipYear();
                        Console.WriteLine("Такой команды нет. Рыбы постарели. Нажмите любую клавишу для продолжения...");
                        Console.ReadKey();
                        break;
                }

                if (_fishCount <= 0)
                    isContinue = false;

                Console.Clear();
            }
        }

        private void AddFish()
        {
            if (!IsFull)
            {
                Console.Write("Введите название рыбы, которую хотите добавить: ");
                string name = Console.ReadLine();
                _fishes.Add(new Fish(name));
                _fishCount++;

                if (_fishCount == _fishMax)
                    IsFull = true;
            }
            else
            {
                Console.WriteLine("Аквариум заполнен, рыба не добавлена. Нажмите любую клавишу для продолжения...");
                Console.ReadKey();
            }

            Console.Clear();
            SkipYear();
        }

        private void GetOutFish()
        {
            Console.Write("Введите название рыбы, которую хотите достать: ");
            string name = Console.ReadLine();

            Fish fish = FindFish(name);

            if(fish == null)
            {
                Console.WriteLine("Такой рыбы нет в аквариуме. Нажмите любую клавишу для продолжения....");
                Console.ReadKey();
            }
            else
            {
                _fishes.Remove(fish);
                _fishCount--;
            }

            SkipYear();
        }

        private void ShowInfo()
        {
            Console.WriteLine("Информация об аквариуме:");

            for (int i = 0; i < _fishes.Count; i++)
            {
                _fishes[i].ShowInfo();
            }
        }

        private Fish FindFish(string name)
        {
            Fish fish = null;

            for (int i = 0; i < _fishes.Count; i++)
            {
                if (name == _fishes[i].Name)
                {
                    fish = _fishes[i];
                    _fishCount--;
                }
                    
            }

            return fish;
        }

        private void SkipYear()
        {
            for (int i = 0; i < _fishes.Count; i++)
            {
                _fishes[i].SkipYear();
            }

            for (int i = 0; i < _fishes.Count; i++)
            {
                if (_fishes[i].Age == _ageOfDeath)
                {
                    _fishes.Remove(_fishes[i]);
                    _fishCount--;
                }
            }
        }
    }

    class Fish
    {
        public int Age { get; private set; }

        public string Name { get; private set; }

        public Fish(string name)
        {
            Name = name;
            Age = 0;
        }

        public void ShowInfo()
        {
            Console.WriteLine($"{Name}. Возраст: {Age}");
        }

        public void SkipYear()
        {
            Age++;
        }
    }
}
